<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <script src="../../script/api.js"></script>
</head>
<body>
    <form id="regsubfrom" onsubmit="return sub();">
                    <div class="mdmlogin">
                        <div class="zhanghao"><input type="text" name="oldpwd" id="oldpwd" placeholder="请输入原密码"></div>
                        <div class="zhanghao"><input type="text" name="newpwd" id="newpwd" placeholder="请输入新密码"></div>

                        <input type="submit" tapmode="hover" value="提交" class="loginbtn">
                    </div>
                    </form>
                </body>
                </html>
<script>
function sub(){
    var oldpwd=$('#oldpwd').val();
    var newpwd=$('#newpwd').val();
    var url=createUrl('user',{'fun':'pwdUpdate','oldpwd':oldpwd,'newpwd':newpwd});
    getJson(url,'数据提交中',function(data){
        if(data.s==1){
            var signature = api.require('signature');
            var newpwd_md5 = signature.md5Sync({
                'data': newpwd,
                'uppercase': false
            });
            set('DD_PASSWORD',newpwd_md5);
            toast('修改成功',1000);
        }else{
            openAlert(data.r);
        }
    },0);
    return false;
}

ready(function(){
    setTitle('密码设置');
},1);
</script>
